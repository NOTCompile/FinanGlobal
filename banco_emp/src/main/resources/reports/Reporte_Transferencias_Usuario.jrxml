<!-- Created with Jaspersoft Studio version 7.0.3.final using JasperReports Library version 7.0.3-41034ca841d452f3305ba55b9042260aaa1ab5dd  -->
<jasperReport name="transferencias_usuario" language="java" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="a1b2c3d4-e5f6-7a8b-9c0d-1e2f3a4b5c6d">
    <property name="com.jaspersoft.studio.data.defaultdataadapter" value="PostgresBanco"/>
    <property name="com.jaspersoft.studio.unit." value="pixel"/>
    <property name="com.jaspersoft.studio.unit.pageHeight" value="pixel"/>
    <property name="com.jaspersoft.studio.unit.pageWidth" value="pixel"/>
    <parameter name="idUsuario" class="java.lang.Long">
        <defaultValueExpression><![CDATA[1L]]></defaultValueExpression>
    </parameter>
    <query language="SQL"><![CDATA[SELECT
    tr.id,
    tr.fecha,
    tr.monto,
    tt.nombre AS tipo_transferencia,
    CONCAT(ue.nombre, ' ', ue.apellidos) AS emisor_nombre,
    ce.nombre AS emisor_cuenta,
    ce.n_cuenta AS emisor_numero_cuenta,
    CONCAT(ur.nombre, ' ', ur.apellidos) AS receptor_nombre,
    cr.nombre AS receptor_cuenta,
    cr.n_cuenta AS receptor_numero_cuenta,
    CASE
        WHEN tr.id_usuario_emisor = $P{idUsuario} THEN 'ENVIADO'
        ELSE 'RECIBIDO'
    END AS tipo_operacion
FROM transferencia tr
JOIN tipo_transferencia tt ON tr.id_tipo = tt.id
JOIN t_usuario ue ON tr.id_usuario_emisor = ue.id_usuario
JOIN cuenta_bancaria ce ON tr.id_cuenta_emisor = ce.id
JOIN t_usuario ur ON tr.id_usuario_receptor = ur.id_usuario
JOIN cuenta_bancaria cr ON tr.id_cuenta_receptor = cr.id
WHERE tr.id_usuario_emisor = $P{idUsuario} OR tr.id_usuario_receptor = $P{idUsuario}
ORDER BY tr.fecha DESC]]></query>
    <field name="id" class="java.lang.Long"/>
    <field name="fecha" class="java.sql.Timestamp"/>
    <field name="monto" class="java.math.BigDecimal"/>
    <field name="tipo_transferencia" class="java.lang.String"/>
    <field name="emisor_nombre" class="java.lang.String"/>
    <field name="emisor_cuenta" class="java.lang.String"/>
    <field name="emisor_numero_cuenta" class="java.lang.String"/>
    <field name="receptor_nombre" class="java.lang.String"/>
    <field name="receptor_cuenta" class="java.lang.String"/>
    <field name="receptor_numero_cuenta" class="java.lang.String"/>
    <field name="tipo_operacion" class="java.lang.String"/>
    <variable name="total_enviado" calculation="Sum" class="java.math.BigDecimal">
        <expression><![CDATA[$F{tipo_operacion}.equals("ENVIADO") ? $F{monto} : new BigDecimal(0)]]></expression>
        <initialValueExpression><![CDATA[new BigDecimal(0)]]></initialValueExpression>
    </variable>
    <variable name="total_recibido" calculation="Sum" class="java.math.BigDecimal">
        <expression><![CDATA[$F{tipo_operacion}.equals("RECIBIDO") ? $F{monto} : new BigDecimal(0)]]></expression>
        <initialValueExpression><![CDATA[new BigDecimal(0)]]></initialValueExpression>
    </variable>
    <variable name="contador" calculation="Count" class="java.lang.Integer">
        <expression><![CDATA[$F{id}]]></expression>
        <initialValueExpression><![CDATA[0]]></initialValueExpression>
    </variable>
    <title height="100" splitType="Stretch">
        <element kind="rectangle" uuid="a1b2c3d4-e5f6-7a8b-9c0d-1e2f3a4b5c6d" x="0" y="0" width="802" height="100" backcolor="#1A3A5C">
            <pen lineWidth="0.0"/>
        </element>
        <element kind="rectangle" uuid="b2c3d4e5-f6a7-8b9c-0d1e-2f3a4b5c6d7e" x="0" y="0" width="802" height="5" backcolor="#3B82F6">
            <pen lineWidth="0.0"/>
        </element>
        <element kind="rectangle" uuid="c3d4e5f6-a7b8-9c0d-1e2f-3a4b5c6d7e8f" x="20" y="20" width="60" height="60" backcolor="#3B82F6">
            <pen lineWidth="2.0" lineColor="#FFFFFF"/>
        </element>
        <element kind="staticText" uuid="d4e5f6a7-b8c9-0d1e-2f3a-4b5c6d7e8f9a" x="25" y="35" width="50" height="30" forecolor="#FFFFFF" fontSize="20.0" bold="true" hTextAlign="Center" vTextAlign="Middle">
            <text><![CDATA[ðŸ’¸]]></text>
        </element>
        <element kind="staticText" uuid="e5f6a7b8-c9d0-1e2f-3a4b-5c6d7e8f9a0b" x="90" y="20" width="700" height="25" forecolor="#3B82F6" fontSize="16.0" bold="true" vTextAlign="Middle">
            <text><![CDATA[FinanGlobal S.A.C]]></text>
        </element>
        <element kind="staticText" uuid="f6a7b8c9-d0e1-2f3a-4b5c-6d7e8f9a0b1c" x="90" y="45" width="700" height="30" forecolor="#FFFFFF" fontSize="20.0" bold="true" hTextAlign="Left" vTextAlign="Middle">
            <text><![CDATA[REPORTE DE TRANSFERENCIAS DEL USUARIO]]></text>
        </element>
        <element kind="staticText" uuid="a7b8c9d0-e1f2-3a4b-5c6d-7e8f9a0b1c2d" x="90" y="75" width="700" height="20" forecolor="#E0E0E0" fontSize="11.0" italic="true" hTextAlign="Left" vTextAlign="Middle">
            <text><![CDATA[Historial completo de transferencias enviadas y recibidas]]></text>
        </element>
    </title>
    <pageHeader height="50" splitType="Stretch">
        <element kind="rectangle" uuid="b8c9d0e1-f2a3-4b5c-6d7e-8f9a0b1c2d3e" x="0" y="0" width="802" height="50" backcolor="#F8F9FA">
            <pen lineWidth="0.5" lineColor="#CCCCCC"/>
        </element>
        <element kind="staticText" uuid="c9d0e1f2-a3b4-5c6d-7e8f-9a0b1c2d3e4f" x="10" y="8" width="100" height="15" forecolor="#666666" fontSize="8.0" bold="true" vTextAlign="Middle">
            <text><![CDATA[Fecha de emisiÃ³n:]]></text>
        </element>
        <element kind="textField" uuid="d0e1f2a3-b4c5-6d7e-8f9a-0b1c2d3e4f5a" x="10" y="23" width="200" height="18" forecolor="#1A3A5C" fontSize="10.0" pattern="dd/MM/yyyy HH:mm:ss" bold="true" vTextAlign="Middle">
            <expression><![CDATA[new java.util.Date()]]></expression>
        </element>
        <element kind="textField" uuid="e1f2a3b4-c5d6-7e8f-9a0b-1c2d3e4f5a6b" x="650" y="15" width="100" height="20" forecolor="#1A3A5C" fontSize="11.0" bold="true" hTextAlign="Right" vTextAlign="Middle">
            <expression><![CDATA["PÃ¡gina " + $V{PAGE_NUMBER}]]></expression>
        </element>
        <element kind="textField" uuid="f2a3b4c5-d6e7-8f9a-0b1c-2d3e4f5a6b7c" x="750" y="15" width="50" height="20" forecolor="#1A3A5C" fontSize="11.0" evaluationTime="Report" bold="true" vTextAlign="Middle">
            <expression><![CDATA[" / " + $V{PAGE_NUMBER}]]></expression>
        </element>
        <element kind="line" uuid="a3b4c5d6-e7f8-9a0b-1c2d-3e4f5a6b7c8d" x="0" y="48" width="802" height="1" forecolor="#1A3A5C">
            <pen lineWidth="2.0"/>
        </element>
    </pageHeader>
    <columnHeader height="35" splitType="Stretch">
        <element kind="rectangle" uuid="b4c5d6e7-f8a9-0b1c-2d3e-4f5a6b7c8d9e" x="0" y="0" width="802" height="35" backcolor="#1A3A5C">
            <pen lineWidth="0.0"/>
        </element>
        <element kind="staticText" uuid="c5d6e7f8-a9b0-1c2d-3e4f-5a6b7c8d9e0f" x="10" y="8" width="50" height="20" forecolor="#FFFFFF" fontSize="9.0" bold="true" vTextAlign="Middle">
            <text><![CDATA[ID]]></text>
        </element>
        <element kind="staticText" uuid="d6e7f8a9-b0c1-2d3e-4f5a-6b7c8d9e0f1a" x="70" y="8" width="90" height="20" forecolor="#FFFFFF" fontSize="9.0" bold="true" vTextAlign="Middle">
            <text><![CDATA[Fecha]]></text>
        </element>
        <element kind="staticText" uuid="e7f8a9b0-c1d2-3e4f-5a6b-7c8d9e0f1a2b" x="170" y="8" width="70" height="20" forecolor="#FFFFFF" fontSize="9.0" bold="true" vTextAlign="Middle">
            <text><![CDATA[Tipo]]></text>
        </element>
        <element kind="staticText" uuid="f8a9b0c1-d2e3-4f5a-6b7c-8d9e0f1a2b3c" x="250" y="8" width="150" height="20" forecolor="#FFFFFF" fontSize="9.0" bold="true" vTextAlign="Middle">
            <text><![CDATA[Emisor]]></text>
        </element>
        <element kind="staticText" uuid="a9b0c1d2-e3f4-5a6b-7c8d-9e0f1a2b3c4d" x="410" y="8" width="150" height="20" forecolor="#FFFFFF" fontSize="9.0" bold="true" vTextAlign="Middle">
            <text><![CDATA[Receptor]]></text>
        </element>
        <element kind="staticText" uuid="b0c1d2e3-f4a5-6b7c-8d9e-0f1a2b3c4d5e" x="570" y="8" width="100" height="20" forecolor="#FFFFFF" fontSize="9.0" bold="true" hTextAlign="Right" vTextAlign="Middle">
            <text><![CDATA[Monto]]></text>
        </element>
        <element kind="staticText" uuid="c1d2e3f4-a5b6-7c8d-9e0f-1a2b3c4d5e6f" x="680" y="8" width="110" height="20" forecolor="#FFFFFF" fontSize="9.0" bold="true" hTextAlign="Center" vTextAlign="Middle">
            <text><![CDATA[OperaciÃ³n]]></text>
        </element>
    </columnHeader>
    <detail>
        <band height="60" splitType="Stretch">
            <element kind="rectangle" uuid="d2e3f4a5-b6c7-8d9e-0f1a-2b3c4d5e6f7a" x="0" y="0" width="802" height="60" backcolor="#FAFAFA">
                <printWhenExpression><![CDATA[$V{REPORT_COUNT} % 2 == 0]]></printWhenExpression>
                <pen lineWidth="0.0"/>
            </element>
            <element kind="textField" uuid="e3f4a5b6-c7d8-9e0f-1a2b-3c4d5e6f7a8b" x="10" y="8" width="50" height="15" fontSize="8.0" bold="true" vTextAlign="Middle">
                <expression><![CDATA[$F{id}]]></expression>
            </element>
            <element kind="textField" uuid="f4a5b6c7-d8e9-0f1a-2b3c-4d5e6f7a8b9c" x="70" y="8" width="90" height="15" fontSize="8.0" pattern="dd/MM/yyyy HH:mm" vTextAlign="Middle">
                <expression><![CDATA[$F{fecha}]]></expression>
            </element>
            <element kind="textField" uuid="a5b6c7d8-e9f0-1a2b-3c4d-5e6f7a8b9c0d" x="170" y="8" width="70" height="15" forecolor="#666666" fontSize="7.0" vTextAlign="Middle">
                <expression><![CDATA[$F{tipo_transferencia}]]></expression>
            </element>
            <element kind="textField" uuid="b6c7d8e9-f0a1-2b3c-4d5e-6f7a8b9c0d1e" x="250" y="5" width="150" height="15" fontSize="8.0" bold="true" vTextAlign="Middle">
                <expression><![CDATA[$F{emisor_nombre}]]></expression>
            </element>
            <element kind="textField" uuid="c7d8e9f0-a1b2-3c4d-5e6f-7a8b9c0d1e2f" x="250" y="20" width="150" height="12" forecolor="#666666" fontSize="7.0" vTextAlign="Middle">
                <expression><![CDATA[$F{emisor_cuenta}]]></expression>
            </element>
            <element kind="textField" uuid="d8e9f0a1-b2c3-4d5e-6f7a-8b9c0d1e2f3a" x="250" y="32" width="150" height="12" forecolor="#999999" fontSize="7.0" vTextAlign="Middle">
                <expression><![CDATA[$F{emisor_numero_cuenta}]]></expression>
            </element>
            <element kind="textField" uuid="e9f0a1b2-c3d4-5e6f-7a8b-9c0d1e2f3a4b" x="410" y="5" width="150" height="15" fontSize="8.0" bold="true" vTextAlign="Middle">
                <expression><![CDATA[$F{receptor_nombre}]]></expression>
            </element>
            <element kind="textField" uuid="f0a1b2c3-d4e5-6f7a-8b9c-0d1e2f3a4b5c" x="410" y="20" width="150" height="12" forecolor="#666666" fontSize="7.0" vTextAlign="Middle">
                <expression><![CDATA[$F{receptor_cuenta}]]></expression>
            </element>
            <element kind="textField" uuid="a1b2c3d4-e5f6-7a8b-9c0d-1e2f3a4b5c6d" x="410" y="32" width="150" height="12" forecolor="#999999" fontSize="7.0" vTextAlign="Middle">
                <expression><![CDATA[$F{receptor_numero_cuenta}]]></expression>
            </element>
            <element kind="textField" uuid="b2c3d4e5-f6a7-8b9c-0d1e-2f3a4b5c6d7e" x="570" y="15" width="100" height="20" fontSize="11.0" pattern="S/ #,##0.00" bold="true" hTextAlign="Right" vTextAlign="Middle">
                <expression><![CDATA[$F{monto}]]></expression>
            </element>
            <element kind="textField" uuid="c3d4e5f6-a7b8-9c0d-1e2f-3a4b5c6d7e8f" x="680" y="15" width="110" height="20" fontSize="9.0" bold="true" hTextAlign="Center" vTextAlign="Middle">
                <expression><![CDATA[$F{tipo_operacion}.equals("ENVIADO") ? "â†‘ ENVIADO" : "â†“ RECIBIDO"]]></expression>
            </element>
            <element kind="line" uuid="d4e5f6a7-b8c9-0d1e-2f3a-4b5c6d7e8f9a" x="10" y="58" width="782" height="1" forecolor="#E0E0E0"/>
        </band>
    </detail>
    <columnFooter splitType="Stretch"/>
    <pageFooter height="40" splitType="Stretch">
        <element kind="line" uuid="e5f6a7b8-c9d0-1e2f-3a4b-5c6d7e8f9a0b" x="0" y="5" width="802" height="1" forecolor="#1A3A5C">
            <pen lineWidth="1.5"/>
        </element>
        <element kind="staticText" uuid="f6a7b8c9-d0e1-2f3a-4b5c-6d7e8f9a0b1c" x="10" y="12" width="400" height="15" forecolor="#666666" fontSize="8.0" vTextAlign="Middle">
            <text><![CDATA[FinanGlobal S.A.C - Reporte generado automÃ¡ticamente]]></text>
        </element>
        <element kind="textField" uuid="a7b8c9d0-e1f2-3a4b-5c6d-7e8f9a0b1c2d" x="10" y="25" width="400" height="12" forecolor="#999999" fontSize="7.0" pattern="'Generado el' dd/MM/yyyy 'a las' HH:mm:ss" italic="true" vTextAlign="Middle">
            <expression><![CDATA[new java.util.Date()]]></expression>
        </element>
        <element kind="textField" uuid="b8c9d0e1-f2a3-4b5c-6d7e-8f9a0b1c2d3e" x="680" y="12" width="120" height="20" forecolor="#1A3A5C" fontSize="9.0" bold="true" hTextAlign="Right" vTextAlign="Middle">
            <expression><![CDATA["PÃ¡gina " + $V{PAGE_NUMBER}]]></expression>
        </element>
        <element kind="staticText" uuid="c9d0e1f2-a3b4-5c6d-7e8f-9a0b1c2d3e4f" x="420" y="25" width="380" height="12" forecolor="#CC0000" fontSize="7.0" bold="true" italic="true" hTextAlign="Right" vTextAlign="Middle">
            <text><![CDATA[DOCUMENTO CONFIDENCIAL - USO INTERNO]]></text>
        </element>
    </pageFooter>
    <summary height="120" splitType="Stretch">
        <element kind="line" uuid="d0e1f2a3-b4c5-6d7e-8f9a-0b1c2d3e4f5a" x="0" y="10" width="802" height="1" forecolor="#1A3A5C">
            <pen lineWidth="2.0"/>
        </element>
        <element kind="rectangle" uuid="e1f2a3b4-c5d6-7e8f-9a0b-1c2d3e4f5a6b" x="0" y="20" width="802" height="90" backcolor="#E8F4F8">
            <pen lineWidth="1.5" lineColor="#1A3A5C"/>
        </element>
        <element kind="staticText" uuid="f2a3b4c5-d6e7-8f9a-0b1c-2d3e4f5a6b7c" x="20" y="30" width="300" height="25" forecolor="#1A3A5C" fontSize="14.0" bold="true" vTextAlign="Middle">
            <text><![CDATA[ðŸ“Š RESUMEN DE TRANSFERENCIAS]]></text>
        </element>
        <element kind="line" uuid="a3b4c5d6-e7f8-9a0b-1c2d-3e4f5a6b7c8d" x="20" y="58" width="300" height="2" forecolor="#3B82F6">
            <pen lineWidth="2.0"/>
        </element>
        <element kind="staticText" uuid="b4c5d6e7-f8a9-0b1c-2d3e-4f5a6b7c8d9e" x="30" y="70" width="150" height="18" forecolor="#1A3A5C" fontSize="10.0" bold="true" vTextAlign="Middle">
            <text><![CDATA[ðŸ“‹ Total de Registros:]]></text>
        </element>
        <element kind="textField" uuid="c5d6e7f8-a9b0-1c2d-3e4f-5a6b7c8d9e0f" x="180" y="70" width="100" height="18" forecolor="#1A3A5C" fontSize="11.0" bold="true" hTextAlign="Right" vTextAlign="Middle">
            <expression><![CDATA[$V{contador}]]></expression>
        </element>
        <element kind="staticText" uuid="d6e7f8a9-b0c1-2d3e-4f5a-6b7c8d9e0f1a" x="320" y="70" width="150" height="18" forecolor="#CC0000" fontSize="10.0" bold="true" vTextAlign="Middle">
            <text><![CDATA[â†‘ Total Enviado:]]></text>
        </element>
        <element kind="textField" uuid="e7f8a9b0-c1d2-3e4f-5a6b-7c8d9e0f1a2b" x="470" y="70" width="120" height="18" forecolor="#CC0000" fontSize="11.0" pattern="S/ #,##0.00" bold="true" hTextAlign="Right" vTextAlign="Middle">
            <expression><![CDATA[$V{total_enviado}]]></expression>
        </element>
        <element kind="staticText" uuid="f8a9b0c1-d2e3-4f5a-6b7c-8d9e0f1a2b3c" x="610" y="70" width="150" height="18" forecolor="#006400" fontSize="10.0" bold="true" vTextAlign="Middle">
            <text><![CDATA[â†“ Total Recibido:]]></text>
        </element>
        <element kind="textField" uuid="a9b0c1d2-e3f4-5a6b-7c8d-9e0f1a2b3c4d" x="660" y="70" width="130" height="18" forecolor="#006400" fontSize="11.0" pattern="S/ #,##0.00" bold="true" hTextAlign="Right" vTextAlign="Middle">
            <expression><![CDATA[$V{total_recibido}]]></expression>
        </element>
    </summary>
</jasperReport>