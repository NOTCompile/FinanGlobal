<!-- Created with Jaspersoft Studio version 7.0.3.final using JasperReports Library version 7.0.3-41034ca841d452f3305ba55b9042260aaa1ab5dd  -->
<jasperReport name="empenos_usuario" language="java" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="a1b2c3d4-e5f6-7a8b-9c0d-1e2f3a4b5c6d">
    <property name="com.jaspersoft.studio.data.defaultdataadapter" value="PostgresBanco"/>
    <property name="com.jaspersoft.studio.unit." value="pixel"/>
    <property name="com.jaspersoft.studio.unit.pageHeight" value="pixel"/>
    <property name="com.jaspersoft.studio.unit.pageWidth" value="pixel"/>
    <parameter name="idUsuario" class="java.lang.Long">
        <defaultValueExpression><![CDATA[1L]]></defaultValueExpression>
    </parameter>
    <query language="SQL"><![CDATA[SELECT
    e.id,
    p.nombre AS nombre_producto,
    tp.nombre AS tipo_producto,
    p.valor_solicitado,
    e.valor_prestado,
    e.valor_recuperacion,
    e.fecha_inicio,
    e.fecha_final,
    es.nombre AS estado,
    es.descripcion AS estado_descripcion,
    CONCAT(u.nombre, ' ', u.apellidos) AS nombre_completo,
    u.dni_ruc,
    u.telefono,
    CASE
        WHEN e.fecha_final >= CURRENT_DATE THEN (e.fecha_final - CURRENT_DATE)
        ELSE 0
    END AS dias_restantes
FROM empeno e
JOIN producto p ON e.id_producto = p.id
JOIN tipo_producto tp ON p.id_tipo = tp.id
JOIN estado es ON e.id_estado = es.id
JOIN lista_empenos le ON e.id = le.id_empeno
JOIN t_usuario u ON le.id_usuario = u.id_usuario
WHERE u.id_usuario = $P{idUsuario}
ORDER BY e.fecha_inicio DESC]]></query>
    <field name="id" class="java.lang.Long"/>
    <field name="nombre_producto" class="java.lang.String"/>
    <field name="tipo_producto" class="java.lang.String"/>
    <field name="valor_solicitado" class="java.math.BigDecimal"/>
    <field name="valor_prestado" class="java.math.BigDecimal"/>
    <field name="valor_recuperacion" class="java.math.BigDecimal"/>
    <field name="fecha_inicio" class="java.sql.Date"/>
    <field name="fecha_final" class="java.sql.Date"/>
    <field name="estado" class="java.lang.String"/>
    <field name="estado_descripcion" class="java.lang.String"/>
    <field name="nombre_completo" class="java.lang.String"/>
    <field name="dni_ruc" class="java.lang.String"/>
    <field name="telefono" class="java.lang.String"/>
    <field name="dias_restantes" class="java.lang.Integer"/>
    <variable name="total_prestado" calculation="Sum" class="java.math.BigDecimal">
        <expression><![CDATA[$F{valor_prestado}]]></expression>
        <initialValueExpression><![CDATA[new BigDecimal(0)]]></initialValueExpression>
    </variable>
    <variable name="total_recuperacion" calculation="Sum" class="java.math.BigDecimal">
        <expression><![CDATA[$F{valor_recuperacion}]]></expression>
        <initialValueExpression><![CDATA[new BigDecimal(0)]]></initialValueExpression>
    </variable>
    <variable name="contador" calculation="Count" class="java.lang.Integer">
        <expression><![CDATA[$F{id}]]></expression>
        <initialValueExpression><![CDATA[0]]></initialValueExpression>
    </variable>
    <title height="100" splitType="Stretch">
        <element kind="rectangle" uuid="a1b2c3d4-e5f6-7a8b-9c0d-1e2f3a4b5c6d" x="0" y="0" width="802" height="100" backcolor="#1A3A5C">
            <pen lineWidth="0.0"/>
        </element>
        <element kind="rectangle" uuid="b2c3d4e5-f6a7-8b9c-0d1e-2f3a4b5c6d7e" x="0" y="0" width="802" height="5" backcolor="#F59E0B">
            <pen lineWidth="0.0"/>
        </element>
        <element kind="rectangle" uuid="c3d4e5f6-a7b8-9c0d-1e2f-3a4b5c6d7e8f" x="20" y="20" width="60" height="60" backcolor="#F59E0B">
            <pen lineWidth="2.0" lineColor="#FFFFFF"/>
        </element>
        <element kind="staticText" uuid="d4e5f6a7-b8c9-0d1e-2f3a-4b5c6d7e8f9a" x="25" y="35" width="50" height="30" forecolor="#FFFFFF" fontSize="20.0" bold="true" hTextAlign="Center" vTextAlign="Middle">
            <text><![CDATA[ðŸ’Ž]]></text>
        </element>
        <element kind="staticText" uuid="e5f6a7b8-c9d0-1e2f-3a4b-5c6d7e8f9a0b" x="90" y="20" width="700" height="25" forecolor="#F59E0B" fontSize="16.0" bold="true" vTextAlign="Middle">
            <text><![CDATA[FinanGlobal S.A.C]]></text>
        </element>
        <element kind="staticText" uuid="f6a7b8c9-d0e1-2f3a-4b5c-6d7e8f9a0b1c" x="90" y="45" width="700" height="30" forecolor="#FFFFFF" fontSize="20.0" bold="true" hTextAlign="Left" vTextAlign="Middle">
            <text><![CDATA[REPORTE DE EMPEÃ‘OS DEL USUARIO]]></text>
        </element>
        <element kind="staticText" uuid="a7b8c9d0-e1f2-3a4b-5c6d-7e8f9a0b1c2d" x="90" y="75" width="700" height="20" forecolor="#E0E0E0" fontSize="11.0" italic="true" hTextAlign="Left" vTextAlign="Middle">
            <text><![CDATA[Historial completo de empeÃ±os y productos valorados]]></text>
        </element>
    </title>
    <pageHeader height="50" splitType="Stretch">
        <element kind="rectangle" uuid="b8c9d0e1-f2a3-4b5c-6d7e-8f9a0b1c2d3e" x="0" y="0" width="802" height="50" backcolor="#F8F9FA">
            <pen lineWidth="0.5" lineColor="#CCCCCC"/>
        </element>
        <element kind="staticText" uuid="c9d0e1f2-a3b4-5c6d-7e8f-9a0b1c2d3e4f" x="10" y="8" width="100" height="15" forecolor="#666666" fontSize="8.0" bold="true" vTextAlign="Middle">
            <text><![CDATA[Fecha de emisiÃ³n:]]></text>
        </element>
        <element kind="textField" uuid="d0e1f2a3-b4c5-6d7e-8f9a-0b1c2d3e4f5a" x="10" y="23" width="200" height="18" forecolor="#1A3A5C" fontSize="10.0" pattern="dd/MM/yyyy HH:mm:ss" bold="true" vTextAlign="Middle">
            <expression><![CDATA[new java.util.Date()]]></expression>
        </element>
        <element kind="textField" uuid="e1f2a3b4-c5d6-7e8f-9a0b-1c2d3e4f5a6b" x="650" y="15" width="100" height="20" forecolor="#1A3A5C" fontSize="11.0" bold="true" hTextAlign="Right" vTextAlign="Middle">
            <expression><![CDATA["PÃ¡gina " + $V{PAGE_NUMBER}]]></expression>
        </element>
        <element kind="textField" uuid="f2a3b4c5-d6e7-8f9a-0b1c-2d3e4f5a6b7c" x="750" y="15" width="50" height="20" forecolor="#1A3A5C" fontSize="11.0" evaluationTime="Report" bold="true" vTextAlign="Middle">
            <expression><![CDATA[" / " + $V{PAGE_NUMBER}]]></expression>
        </element>
        <element kind="line" uuid="a3b4c5d6-e7f8-9a0b-1c2d-3e4f5a6b7c8d" x="0" y="48" width="802" height="1" forecolor="#1A3A5C">
            <pen lineWidth="2.0"/>
        </element>
    </pageHeader>
    <columnHeader height="35" splitType="Stretch">
        <element kind="rectangle" uuid="b4c5d6e7-f8a9-0b1c-2d3e-4f5a6b7c8d9e" x="0" y="0" width="802" height="35" backcolor="#1A3A5C">
            <pen lineWidth="0.0"/>
        </element>
        <element kind="staticText" uuid="c5d6e7f8-a9b0-1c2d-3e4f-5a6b7c8d9e0f" x="10" y="8" width="40" height="20" forecolor="#FFFFFF" fontSize="9.0" bold="true" vTextAlign="Middle">
            <text><![CDATA[ID]]></text>
        </element>
        <element kind="staticText" uuid="d6e7f8a9-b0c1-2d3e-4f5a-6b7c8d9e0f1a" x="60" y="8" width="140" height="20" forecolor="#FFFFFF" fontSize="9.0" bold="true" vTextAlign="Middle">
            <text><![CDATA[Producto]]></text>
        </element>
        <element kind="staticText" uuid="e7f8a9b0-c1d2-3e4f-5a6b-7c8d9e0f1a2b" x="210" y="8" width="80" height="20" forecolor="#FFFFFF" fontSize="9.0" bold="true" vTextAlign="Middle">
            <text><![CDATA[Tipo]]></text>
        </element>
        <element kind="staticText" uuid="f8a9b0c1-d2e3-4f5a-6b7c-8d9e0f1a2b3c" x="300" y="8" width="90" height="20" forecolor="#FFFFFF" fontSize="9.0" bold="true" hTextAlign="Right" vTextAlign="Middle">
            <text><![CDATA[Val. Solicitado]]></text>
        </element>
        <element kind="staticText" uuid="a9b0c1d2-e3f4-5a6b-7c8d-9e0f1a2b3c4d" x="400" y="8" width="90" height="20" forecolor="#FFFFFF" fontSize="9.0" bold="true" hTextAlign="Right" vTextAlign="Middle">
            <text><![CDATA[Val. Prestado]]></text>
        </element>
        <element kind="staticText" uuid="b0c1d2e3-f4a5-6b7c-8d9e-0f1a2b3c4d5e" x="500" y="8" width="90" height="20" forecolor="#FFFFFF" fontSize="9.0" bold="true" hTextAlign="Right" vTextAlign="Middle">
            <text><![CDATA[RecuperaciÃ³n]]></text>
        </element>
        <element kind="staticText" uuid="c1d2e3f4-a5b6-7c8d-9e0f-1a2b3c4d5e6f" x="600" y="8" width="80" height="20" forecolor="#FFFFFF" fontSize="9.0" bold="true" hTextAlign="Center" vTextAlign="Middle">
            <text><![CDATA[Fechas]]></text>
        </element>
        <element kind="staticText" uuid="d2e3f4a5-b6c7-8d9e-0f1a-2b3c4d5e6f7a" x="690" y="8" width="100" height="20" forecolor="#FFFFFF" fontSize="9.0" bold="true" hTextAlign="Center" vTextAlign="Middle">
            <text><![CDATA[Estado]]></text>
        </element>
    </columnHeader>
    <detail>
        <band height="70" splitType="Stretch">
            <element kind="rectangle" uuid="e3f4a5b6-c7d8-9e0f-1a2b-3c4d5e6f7a8b" x="0" y="0" width="802" height="70" backcolor="#FAFAFA">
                <printWhenExpression><![CDATA[$V{REPORT_COUNT} % 2 == 0]]></printWhenExpression>
                <pen lineWidth="0.0"/>
            </element>
            <element kind="textField" uuid="f4a5b6c7-d8e9-0f1a-2b3c-4d5e6f7a8b9c" x="10" y="10" width="40" height="15" fontSize="8.0" bold="true" vTextAlign="Middle">
                <expression><![CDATA[$F{id}]]></expression>
            </element>
            <element kind="textField" uuid="a5b6c7d8-e9f0-1a2b-3c4d-5e6f7a8b9c0d" x="60" y="5" width="140" height="18" fontSize="9.0" bold="true" vTextAlign="Middle">
                <expression><![CDATA[$F{nombre_producto}]]></expression>
            </element>
            <element kind="textField" uuid="b6c7d8e9-f0a1-2b3c-4d5e-6f7a8b9c0d1e" x="210" y="10" width="80" height="15" forecolor="#666666" fontSize="8.0" vTextAlign="Middle">
                <expression><![CDATA[$F{tipo_producto}]]></expression>
            </element>
            <element kind="textField" uuid="c7d8e9f0-a1b2-3c4d-5e6f-7a8b9c0d1e2f" x="300" y="10" width="90" height="15" forecolor="#666666" fontSize="8.0" pattern="S/ #,##0.00" hTextAlign="Right" vTextAlign="Middle">
                <expression><![CDATA[$F{valor_solicitado}]]></expression>
            </element>
            <element kind="textField" uuid="d8e9f0a1-b2c3-4d5e-6f7a-8b9c0d1e2f3a" x="400" y="10" width="90" height="15" forecolor="#0066CC" fontSize="9.0" pattern="S/ #,##0.00" bold="true" hTextAlign="Right" vTextAlign="Middle">
                <expression><![CDATA[$F{valor_prestado}]]></expression>
            </element>
            <element kind="textField" uuid="e9f0a1b2-c3d4-5e6f-7a8b-9c0d1e2f3a4b" x="500" y="10" width="90" height="15" forecolor="#CC0000" fontSize="9.0" pattern="S/ #,##0.00" bold="true" hTextAlign="Right" vTextAlign="Middle">
                <expression><![CDATA[$F{valor_recuperacion}]]></expression>
            </element>
            <element kind="staticText" uuid="f0a1b2c3-d4e5-6f7a-8b9c-0d1e2f3a4b5c" x="600" y="5" width="35" height="12" forecolor="#666666" fontSize="7.0" bold="true" vTextAlign="Middle">
                <text><![CDATA[Inicio:]]></text>
            </element>
            <element kind="textField" uuid="a1b2c3d4-e5f6-7a8b-9c0d-1e2f3a4b5c6d" x="635" y="5" width="50" height="12" forecolor="#333333" fontSize="7.0" pattern="dd/MM/yyyy" vTextAlign="Middle">
                <expression><![CDATA[$F{fecha_inicio}]]></expression>
            </element>
            <element kind="staticText" uuid="b2c3d4e5-f6a7-8b9c-0d1e-2f3a4b5c6d7e" x="600" y="18" width="35" height="12" forecolor="#666666" fontSize="7.0" bold="true" vTextAlign="Middle">
                <text><![CDATA[Final:]]></text>
            </element>
            <element kind="textField" uuid="c3d4e5f6-a7b8-9c0d-1e2f-3a4b5c6d7e8f" x="635" y="18" width="50" height="12" forecolor="#333333" fontSize="7.0" pattern="dd/MM/yyyy" vTextAlign="Middle">
                <expression><![CDATA[$F{fecha_final}]]></expression>
            </element>
            <element kind="textField" uuid="d4e5f6a7-b8c9-0d1e-2f3a-4b5c6d7e8f9a" x="600" y="35" width="80" height="20" fontSize="8.0" bold="true" hTextAlign="Center" vTextAlign="Middle">
                <expression><![CDATA[$F{dias_restantes} > 0 ? "â± " + $F{dias_restantes} + " dÃ­as" : "âš  Vencido"]]></expression>
            </element>
            <element kind="rectangle" uuid="e5f6a7b8-c9d0-1e2f-3a4b-5c6d7e8f9a0b" x="690" y="5" width="100" height="50">
                <pen lineWidth="1.0" lineColor="#CCCCCC"/>
            </element>
            <element kind="textField" uuid="f6a7b8c9-d0e1-2f3a-4b5c-6d7e8f9a0b1c" x="695" y="10" width="90" height="15" fontSize="9.0" bold="true" hTextAlign="Center" vTextAlign="Middle">
                <expression><![CDATA[$F{estado}]]></expression>
            </element>
            <element kind="textField" uuid="a7b8c9d0-e1f2-3a4b-5c6d-7e8f9a0b1c2d" x="695" y="28" width="90" height="22" forecolor="#666666" fontSize="7.0" italic="true" hTextAlign="Center" vTextAlign="Middle">
                <expression><![CDATA[$F{estado_descripcion}]]></expression>
            </element>
            <element kind="line" uuid="b8c9d0e1-f2a3-4b5c-6d7e-8f9a0b1c2d3e" x="10" y="68" width="782" height="1" forecolor="#E0E0E0"/>
        </band>
    </detail>
    <columnFooter splitType="Stretch"/>
    <pageFooter height="40" splitType="Stretch">
        <element kind="line" uuid="c9d0e1f2-a3b4-5c6d-7e8f-9a0b1c2d3e4f" x="0" y="5" width="802" height="1" forecolor="#1A3A5C">
            <pen lineWidth="1.5"/>
        </element>
        <element kind="staticText" uuid="d0e1f2a3-b4c5-6d7e-8f9a-0b1c2d3e4f5a" x="10" y="12" width="400" height="15" forecolor="#666666" fontSize="8.0" vTextAlign="Middle">
            <text><![CDATA[FinanGlobal S.A.C - Reporte generado automÃ¡ticamente]]></text>
        </element>
        <element kind="textField" uuid="e1f2a3b4-c5d6-7e8f-9a0b-1c2d3e4f5a6b" x="10" y="25" width="400" height="12" forecolor="#999999" fontSize="7.0" pattern="'Generado el' dd/MM/yyyy 'a las' HH:mm:ss" italic="true" vTextAlign="Middle">
            <expression><![CDATA[new java.util.Date()]]></expression>
        </element>
        <element kind="textField" uuid="f2a3b4c5-d6e7-8f9a-0b1c-2d3e4f5a6b7c" x="680" y="12" width="120" height="20" forecolor="#1A3A5C" fontSize="9.0" bold="true" hTextAlign="Right" vTextAlign="Middle">
            <expression><![CDATA["PÃ¡gina " + $V{PAGE_NUMBER}]]></expression>
        </element>
        <element kind="staticText" uuid="a3b4c5d6-e7f8-9a0b-1c2d-3e4f5a6b7c8d" x="420" y="25" width="380" height="12" forecolor="#CC0000" fontSize="7.0" bold="true" italic="true" hTextAlign="Right" vTextAlign="Middle">
            <text><![CDATA[DOCUMENTO CONFIDENCIAL - USO INTERNO]]></text>
        </element>
    </pageFooter>
    <summary height="120" splitType="Stretch">
        <element kind="line" uuid="b4c5d6e7-f8a9-0b1c-2d3e-4f5a6b7c8d9e" x="0" y="10" width="802" height="1" forecolor="#1A3A5C">
            <pen lineWidth="2.0"/>
        </element>
        <element kind="rectangle" uuid="c5d6e7f8-a9b0-1c2d-3e4f-5a6b7c8d9e0f" x="0" y="20" width="802" height="90" backcolor="#FEF3C7">
            <pen lineWidth="1.5" lineColor="#F59E0B"/>
        </element>
        <element kind="staticText" uuid="d6e7f8a9-b0c1-2d3e-4f5a-6b7c8d9e0f1a" x="20" y="30" width="300" height="25" forecolor="#92400E" fontSize="14.0" bold="true" vTextAlign="Middle">
            <text><![CDATA[ðŸ“Š RESUMEN DE EMPEÃ‘OS]]></text>
        </element>
        <element kind="line" uuid="e7f8a9b0-c1d2-3e4f-5a6b-7c8d9e0f1a2b" x="20" y="58" width="300" height="2" forecolor="#F59E0B">
            <pen lineWidth="2.0"/>
        </element>
        <element kind="staticText" uuid="f8a9b0c1-d2e3-4f5a-6b7c-8d9e0f1a2b3c" x="30" y="70" width="150" height="18" forecolor="#92400E" fontSize="10.0" bold="true" vTextAlign="Middle">
            <text><![CDATA[ðŸ“‹ Total de EmpeÃ±os:]]></text>
        </element>
        <element kind="textField" uuid="a9b0c1d2-e3f4-5a6b-7c8d-9e0f1a2b3c4d" x="180" y="70" width="100" height="18" forecolor="#92400E" fontSize="11.0" bold="true" hTextAlign="Right" vTextAlign="Middle">
            <expression><![CDATA[$V{contador}]]></expression>
        </element>
        <element kind="staticText" uuid="b0c1d2e3-f4a5-6b7c-8d9e-0f1a2b3c4d5e" x="310" y="70" width="170" height="18" forecolor="#0066CC" fontSize="10.0" bold="true" vTextAlign="Middle">
            <text><![CDATA[ðŸ’° Total Valor Prestado:]]></text>
        </element>
        <element kind="textField" uuid="c1d2e3f4-a5b6-7c8d-9e0f-1a2b3c4d5e6f" x="480" y="70" width="120" height="18" forecolor="#0066CC" fontSize="11.0" pattern="S/ #,##0.00" bold="true" hTextAlign="Right" vTextAlign="Middle">
            <expression><![CDATA[$V{total_prestado}]]></expression>
        </element>
        <element kind="staticText" uuid="d2e3f4a5-b6c7-8d9e-0f1a-0002b3c4d5e6" x="610" y="70" width="170" height="18" forecolor="#CC0000">
            <text><![CDATA[ðŸ”» Total RecuperaciÃ³n:]]></text>
        </element>
        <element kind="textField" uuid="e3f4a5b6-c7d8-9e0f-1a2b-3c4d5e6f7a8b" x="780" y="70" width="120" height="18" forecolor="#CC0000" fontSize="11.0" pattern="S/ #,##0.00" bold="true" hTextAlign="Right" vTextAlign="Middle">
            <expression><![CDATA[$V{total_recuperacion}]]></expression>
        </element>
    </summary>
</jasperReport>
